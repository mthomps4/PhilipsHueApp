<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Philips Hue Web App</title>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <link rel="stylesheet" href="main.css">

  </head>
  <body>
<div class="container">
  <h1>Philips Hue Web App</h1>
      <p>Added Jquery commands to test how light data worked.
        <br> Will work on creating dynamics in Angular2 MVC</p>
        <br>
        <br>

        <h1>Stand Alone Test</h1>
        <div id="colorBar">
              <h3 id="testLightName">Light 1 Test </h3>
              <label class="switch">
                <input id="Test1" type="checkbox" checked>
                <div class="slider"></div>
              </label>
        </div>
        <!-- <input id="Test1" type="checkbox" checked data-toggle="toggle" data-size="large" data-onstyle="info" data-offstyle="danger"> -->

        <!-- <label class="switch">
          <input id="Test1" type="checkbox" checked>
          <div class="slider"></div>
        </label> -->
        <!-- <div id="selectedColor"></div> -->

        <svg class="bulbSVG" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 370 370"><path class="bulbPath" d="M15 20.5c0 .276-.224.5-.5.5h-5c-.276 0-.5-.224-.5-.5s.224-.5.5-.5h5c.276 0 .5.224.5.5zm-.5-2.5h-5c-.276 0-.5.224-.5.5s.224.5.5.5h5c.276 0 .5-.224.5-.5s-.224-.5-.5-.5zm-3.799 5.659c.19.216.465.341.752.341h1.094c.287 0 .562-.125.752-.341l1.451-1.659h-5.5l1.451 1.659zm8.299-16.925c0 4.164-3.75 6.98-3.75 10.266h-6.5c0-3.286-3.75-6.103-3.75-10.266 0-4.343 3.498-6.734 6.996-6.734 3.502 0 7.004 2.394 7.004 6.734zm-7.719-3.015l-.219-1.177c-2.017.373-3.258 1.851-3.517 3.846l1.188.154c.116-.9.602-2.463 2.548-2.823z"/></svg></div>
https://css-tricks.com/scale-svg/
        <div class=centerFlex>
          <div id="colorWheelDemo"></div>
        </div>

        <hr>

        <button id="getData">Return Light State </button>
        <div id="data"></div>
        <hr>

        <input type="button" value="Get Lights" onclick="getLights();" />
        <div id="getLights"></div>
</div>



<!-- Latest compiled and minified JavaScript -->
<script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Color Wheel -->
<script src="iro.min.js"></script>
<script src="app.colorwheel.js"></script>


<!-- Test API Scripts  -->
  <script>
  "use strict";
  //Make sure Light is off on page load
  //Will look to add dynamic 'checks' later
  $('#Test1').removeAttr('checked');
  $.ajax({
       type: "PUT",
       url: "http://192.168.1.107/api/nbEypJkH8KItw3APB3Ci2YIB6t48vW15j6qXBzpm/lights/1/state",
       dataType: 'json',
       contentType: 'application/json',
       data:  JSON.stringify({"on": false}),
       success: function(data, response){
         console.log(response);
         console.log("turning Test1 Off!");
       }
    });

    //Stand Alone Test
    $(document).ready(function() {
        $('#Test1').change(function() {
            if($(this).is(":checked")) {
                $.ajax({
                 type: "PUT",
                 url: "http://192.168.1.107/api/nbEypJkH8KItw3APB3Ci2YIB6t48vW15j6qXBzpm/lights/1/state",
                 dataType: 'json',
                 contentType: 'application/json',
                 data:  JSON.stringify({"on": true}),
                 success: function(data, response){
                   console.log(response);
                   console.log("turning Test1 ON!");
                 }
              });
            }

            else{
              $.ajax({
               type: "PUT",
               url: "http://192.168.1.107/api/nbEypJkH8KItw3APB3Ci2YIB6t48vW15j6qXBzpm/lights/1/state",
               dataType: 'json',
               contentType: 'application/json',
               data:  JSON.stringify({"on": false}),
               success: function(data, response){
                 console.log(response);
                 console.log("turning Test1 Off!");
               }
            });
          }//Else

        });//If button toggled
    });//DocumentReady


//Return Light States
$("#getData").click(function(){
  $("#data").empty();
  $.ajax({
   type: "GET",
   url: "http://192.168.1.107/api/nbEypJkH8KItw3APB3Ci2YIB6t48vW15j6qXBzpm/lights/",
   dataType: 'json',
   contentType: 'application/json',
   success: function(data, response){
     $.each(data, function(key, value){
          $("#data").append("<h3>" + key + "</h3>");
          var str = JSON.stringify(value);
          $("#data").append("<h3>" + value['name'] + "</h3>");
          $("#data").append(str);
          $("#data").append("<br><br>");
          console.log(str);
     });
   }//success
 })
});

//Dynamic Load Test
function getLights() {
  $("#getLights").empty();
    $.ajax({
         type: "GET",
         url: "http://192.168.1.107/api/nbEypJkH8KItw3APB3Ci2YIB6t48vW15j6qXBzpm/lights/",
         dataType: 'json',
         contentType: 'application/json',
         success: function(data, response){
           response = JSON.stringify(data);


           $.each(data, function(key, value){
             var checked = "";
             if(value['state']['on'] == true){
               checked="checked ";
             }
             $("#getLights").append(
               "<h1>"+key + value['name']+"</h1>" +
                `<label class="switch">`+
                  `<input id="Light`+key+`" type="checkbox"` + checked +`onchange="changeLightState(`+key+`)">` +
                  `<div class="slider"></div></label>`
              );
              console.log("Light"+key+" state ON = "+ value['state']['on']);
           });
         }//Success
      });//AJAX
  };//getLights

  //IF ELSE LIGHT SWITCH AJAX
function changeLightState(key){
  var i = key;
  console.log(i);
    if($("#Light"+i).is(":checked")) {
      console.log("checked");
      $.ajax({
        type: "PUT",
        url: "http://192.168.1.107/api/nbEypJkH8KItw3APB3Ci2YIB6t48vW15j6qXBzpm/lights/"+i+"/state",
        dataType: 'json',
        contentType: 'application/json',
        data:  JSON.stringify({"on": true}),
        success: function(data, response){
          console.log("Turning ON");
        }
      });
    }//IF
    else{
      $.ajax({
        type: "PUT",
        url: "http://192.168.1.107/api/nbEypJkH8KItw3APB3Ci2YIB6t48vW15j6qXBzpm/lights/"+i+"/state",
        dataType: 'json',
        contentType: 'application/json',
        data:  JSON.stringify({"on": false}),
        success: function(data, response){
          console.log("Somethings UP");
        }
      });
    }//Else
  }//changeLightState

   </script>
  </body>
</html>
